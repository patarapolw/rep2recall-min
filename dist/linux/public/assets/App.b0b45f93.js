import{a as e}from"./api.622e73a3.js";import a from"./Quiz.19f9913b.js";import{r as t,g as s,h as c,d as l,w as n,p as i,i as d,o,b as r,j as u,F as h,k as v,l as m,n as p,q as b,s as k,t as g,v as f,u as q,x as z,y as w,z as x,A as y}from"./vendor.17072acf.js";var L=l({props:{q:{type:String,required:!0}},setup(a){const l=t([]),i=(d={},e=>{const a=t(1);let l;return s((()=>{l=new IntersectionObserver((([e])=>{(null==e?void 0:e.isIntersecting)&&a.value++}),null!=d?d:{}),l.observe(e.value)})),c((()=>{null==l||l.disconnect()})),a});var d;const o=t(null),r=i(o);return n(r,(t=>{e.get("/api/quiz/leech",{params:{page:t,limit:6,q:a.q}}).then((({data:e})=>{l.value=[...l.value,...e.result]}))}),{immediate:!0}),{leechItems:l,scrollTrigger:o,token:new URL(location.href).searchParams.get("token")}}});const Q=m();i("data-v-5a2ec3d6");const I={id:"LeechContent",class:"card-content"},C={class:"columns"},F={ref:"scrollTrigger"};d();const S=Q(((e,a,t,s,c,l)=>(o(),r("div",I,[u("div",C,[(o(!0),r(h,null,v(e.leechItems,(a=>(o(),r("div",{class:"column is-4",key:a},[u("iframe",{class:"leech-iframe",src:`/card?side=front&id=${a}&token=${e.token}`},null,8,["src"])])))),128)),u("div",F,null,512)])]))));L.render=S,L.__scopeId="data-v-5a2ec3d6";var j=l({components:{Quiz:a,LeechContent:L},setup(){const a=t(new URL(location.href).searchParams.get("q")||""),s=t(["new","learning","due"]),c=t({new:0,due:0,leech:0,next:""}),l=t(!1),i=t(!1),d=t(""),o=()=>{e.get("/api/quiz/stat",{params:{q:a.value,state:s.value.join(",")}}).then((({data:e})=>{c.value=e,l.value&&(l.value=!1,b((()=>{l.value=!0})))}))};return p((()=>{o()})),n(s,(()=>{o()})),{q:a,state:s,doFilter:o,stat:c,doQuiz:()=>{e.post("/api/quiz/init",void 0,{params:{q:a.value,state:s.value.join(",")}}).then((({data:e})=>{d.value=e.id,i.value=!0}))},isLeechOpen:l,isQuiz:i,sessionId:d}}});const O=m();i("data-v-5001cea0");const _={class:"container"},U={class:"field has-addons mt-4"},N={class:"control is-expanded"},P=u("div",{class:"control"},[u("button",{class:"button is-info",type:"submit"},"Filter")],-1),R={id:"State"},T={class:"field"},$={class:"control check-list"},A={class:"checkbox"},D=y(" New "),E={class:"checkbox"},G=y(" Learning "),V={class:"checkbox"},B=y(" Graduated "),H={class:"field"},J={class:"checkbox"},K=y(" Include undue "),M={class:"field"},W={class:"checkbox"},X=y(" Include leeches "),Y={id:"Stat",class:"card mt-4"},Z=u("header",{class:"card-header"},[u("h2",{class:"card-header-title"},"Quiz statistics")],-1),ee={class:"card-content"},ae={class:"columns"},te={class:"column is-4"},se=u("label",{for:"new"},"New:",-1),ce={"data-stat":"",name:"new"},le={class:"column is-4"},ne=u("label",{for:"due"},"Due:",-1),ie={"data-stat":"",name:"due"},de={class:"column is-4"},oe=u("label",{for:"leech"},"Leech:",-1),re={"data-stat":"",name:"leech"},ue={id:"Leech",class:"card mt-4"},he=u("h2",{class:"card-header-title"},"Leeches",-1),ve=u("div",{class:"card-header-icon"},[u("button",{class:"delete",type:"button"})],-1),me={key:0,class:"modal is-active"},pe=u("div",{class:"modal-background"},null,-1),be={class:"modal-card"},ke={class:"modal-card-head"},ge=u("p",{class:"modal-card-title"},"Quiz",-1),fe={class:"modal-card-body"};d();const qe=O(((e,a,t,s,c,l)=>{const n=k("leech-content"),i=k("Quiz");return o(),r("div",_,[u("form",{id:"Filter",onSubmit:a[7]||(a[7]=q(((...a)=>e.doFilter&&e.doFilter(...a)),["prevent"]))},[u("div",U,[u("div",N,[g(u("input",{type:"search",class:"input",name:"q","onUpdate:modelValue":a[1]||(a[1]=a=>e.q=a)},null,512),[[f,e.q]])]),P]),u("div",R,[u("div",T,[u("div",$,[u("label",A,[u("input",{type:"checkbox",name:"learning",checked:e.state.includes("new"),onChange:a[2]||(a[2]=a=>e.state=a.target.checked?[...e.state,"new"]:e.state.filter((e=>"new"!==e)))},null,40,["checked"]),D]),u("label",E,[u("input",{type:"checkbox",name:"learning",checked:e.state.includes("learning"),onChange:a[3]||(a[3]=a=>e.state=a.target.checked?[...e.state,"learning"]:e.state.filter((e=>"learning"!==e)))},null,40,["checked"]),G]),u("label",V,[u("input",{type:"checkbox",name:"learning",checked:e.state.includes("graduated"),onChange:a[4]||(a[4]=a=>e.state=a.target.checked?[...e.state,"graduated"]:e.state.filter((e=>"graduated"!==e)))},null,40,["checked"]),B])])]),u("div",H,[u("label",J,[u("input",{type:"checkbox",checked:!e.state.includes("due"),onChange:a[5]||(a[5]=a=>e.state=a.target.checked?e.state.filter((e=>"due"!==e)):[...e.state,"due"])},null,40,["checked"]),K])]),u("div",M,[u("label",W,[u("input",{type:"checkbox",checked:e.state.includes("leech"),onChange:a[6]||(a[6]=a=>e.state=a.target.checked?[...e.state,"leech"]:e.state.filter((e=>"leech"!==e)))},null,40,["checked"]),X])])])],32),u("div",Y,[Z,u("div",ee,[u("div",ae,[u("div",te,[se,u("div",ce,z(e.stat.new.toLocaleString()),1)]),u("div",le,[ne,u("div",ie,z(e.stat.due.toLocaleString()),1)]),u("div",de,[oe,u("div",re,z(e.stat.leech.toLocaleString()),1)])]),u("form",{class:"field",onSubmit:a[8]||(a[8]=q(((...a)=>e.doQuiz&&e.doQuiz(...a)),["prevent"]))},[u("button",{disabled:e.stat.next||!(e.stat.due||e.stat.new),name:"quiz",class:"button is-success",type:"submit"}," Quiz ",8,["disabled"])],32)])]),g(u("div",ue,[u("header",{class:"card-header clickable",onClick:a[9]||(a[9]=a=>e.isLeechOpen=!e.isLeechOpen)},[he,ve]),e.isLeechOpen?(o(),r(n,{key:0,q:e.q},null,8,["q"])):x("",!0)],512),[[w,!!e.stat.leech]]),e.isQuiz?(o(),r("div",me,[pe,u("div",be,[u("header",ke,[ge,u("button",{class:"delete","aria-label":"close",onClick:a[10]||(a[10]=()=>{e.isQuiz=!1,e.doFilter()})})]),u("section",fe,[u(i,{session:e.sessionId,onEnd:a[11]||(a[11]=()=>{e.isQuiz=!1,e.doFilter()})},null,8,["session"])])])])):x("",!0)])}));j.render=qe,j.__scopeId="data-v-5001cea0";export default j;
